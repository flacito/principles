---
import { getCollection, render } from "astro:content";
import BaseLayout from "../layouts/base-layout.astro";

export async function getStaticPaths() {
  const sections = await getCollection("sections");
  const sorted = sections.sort((a, b) => a.data.order - b.data.order);

  return sorted.map((section, index) => ({
    params: { slug: section.id },
    props: {
      section,
      prev: index > 0 ? sorted[index - 1] : null,
      next: index < sorted.length - 1 ? sorted[index + 1] : null,
    },
  }));
}

const { section, prev, next } = Astro.props;
const { Content } = await render(section);
const base = import.meta.env.BASE_URL;
---

<BaseLayout title={`${section.data.title} â€” Principles`}>
  <Content />
  <nav class="page-nav">
    {
      prev ? (
        <a href={`${base}${prev.id}/`} class="prev">
          <span class="nav-label">Previous</span>
          <span class="nav-title">{prev.data.title}</span>
        </a>
      ) : (
        <span />
      )
    }
    {
      next ? (
        <a href={`${base}${next.id}/`} class="next">
          <span class="nav-label">Next</span>
          <span class="nav-title">{next.data.title}</span>
        </a>
      ) : (
        <span />
      )
    }
  </nav>
</BaseLayout>
